#' Add code based on locality, municipality and state codes
#'
#' @param this.tibble
#'
#' @return code.tibble
#' @export
#'
#' @examples
make_code <- function(this.tibble){

  code.tibble <- this.tibble %>%
    dplyr::mutate(no_loc = nchar(LOC), no_mun = nchar(MUN), no_ent = nchar(ENTIDAD)) %>%
    dplyr::mutate(cve_loc = as.character(LOC), cve_mun = as.character(MUN), cve_ent = as.character(ENTIDAD)) %>%
    dplyr::mutate(cveloc=dplyr::if_else(no_loc==1,paste0("000",cve_loc),
                                        dplyr::if_else(no_loc==2,paste0("00",cve_loc),
                                                       dplyr::if_else(no_loc==3,paste0("0",cve_loc),
                                                                      dplyr::if_else(no_loc==4,cve_loc, cve_loc))))) %>%
    dplyr::mutate(cvemun=dplyr::if_else(no_mun==1,paste0("00",cve_mun),
                                        dplyr::if_else(no_mun==2,paste0("0",cve_mun), cve_mun))) %>%
    dplyr::mutate(cveent=dplyr::if_else(no_ent==1,paste0("0",cve_ent), cve_ent)) %>%
    dplyr::mutate(CVE_LOC = paste0(cveent,cvemun,cveloc), id_row = 1:nrow(.)) %>%
    dplyr::mutate(CVE_MUN = paste0(cveent,cvemun)) %>%
    dplyr::select(id_row, CVE_LOC, CVE_MUN, everything())


  return(code.tibble)
}
