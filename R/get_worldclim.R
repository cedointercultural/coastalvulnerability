#' Get data from WorldClim
#'
#' @param eachscenario
#' @param scenario.names
#' @param file.names
#' @param var.names
#' @param layer.nums
#' @param input.dir
#'
#' @description Get terrestrial historical and future layers from https://www.worldclim.org/data/cmip6/cmip6_clim30s.html
#' @return
#' @export
#'
#' @examples
get_worldclim <- function(eachscenario, scenario.names, file.names, var.names, layer.nums, input.dir, r.template){

  this.file <- file.names[eachscenario]
  print(this.file)

  this.data <- terra::rast(paste0(input.dir,"/worldclim/",this.file))

  this.scenario <- scenario.names[eachscenario]
  print(this.scenario)

  for(eachfile in 1:length(layer.nums)){

    this.layer.num <- layer.nums[eachfile]
    this.data.layer <- this.data[[this.layer.num]]
    this.layer.name <- var.names[eachfile]

    layer.file.name <- paste0(this.path,"/worldclim_",this.scenario,"_",this.layer.name,"_2041-2060.tif")

    crop.data.layer <- terra::crop(this.data.layer, r.template)

    terra::writeRaster(crop.data.layer,layer.file.name, filetype="GTiff", overwrite = TRUE)

    unlink(this.data.layer)
    unlink(crop.data.layer)

  }

}
