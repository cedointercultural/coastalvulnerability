#' @title Mapping coastal communities
#' @description  Functions to make map
#' @details Make map of coastal communities 30 km from coast
#' @keywords function map
#' @usage make_map()
#' @param estados.shp, inegi.cost.wgs, thistitle, thisoutput, ents.selecc
#' @export
#' @return map.locs
#' @example
make_map <- function(mun.cost, inegi.cost, estados.shp, crs.proj.utm, thistitle, thisoutput){


  mun.cost.proj <- sf::st_transform(mun.cost, crs.proj.utm)

  tland.cost  <- tmap::tm_shape(estados.shp) +
    tmap::tm_borders()

  map.locs <- tland.cost +
    tmap::tm_shape(mun.cost.proj) +
    tmap::tm_fill()+
    tmap::tm_shape(inegi.cost, projection = "wgs84") +
    tmap::tm_dots(size = "POBTOT",
                  col = "#273961",
            contrast=1,
            sizes.legend=c(2500,25000,500000,1000000),
            title.size = thistitle) +
    #  tm_grid(col="white", labels.show = FALSE) +
    tmap::tm_scale_bar(breaks=c(0,500,1000),position = c("left", "bottom"), text.size = 0.8) +
    tmap::tm_compass(type = "arrow", position = c("right", "bottom")) +
    tmap::tm_scale_bar(breaks = c(0, 100, 200), text.size = 1)

  tmap::tmap_save(map.locs, filename=thisoutput, width=10, height = 6, dpi = 300)

  return(map.locs)
}
