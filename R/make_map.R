#' @title Mapping coastal communities
#' @description  Functions to make map
#' @details Make map of coastal communities 30 km from coast
#' @keywords function map
#' @usage make_map()
#' @param estados.shp, inegi.cost.wgs, thistitle, thisoutput, ents.selecc
#' @export
#' @return map.locs


make_map <- function(estados.shp, inegi.cost.wgs, thistitle, thisoutput, ents.selecc){

  estados.shp.proj <- sf::st_transform(estados.shp, crs.proj.utm)

 inegi.ents <- inegi.cost.wgs %>%
    dplyr::filter(NOM_ENT %in% ents.selecc)

  tland <- tmap::tm_shape(estados.shp.proj) +
    tmap::tm_fill()+
    tmap::tm_borders()

  map.locs <- tland +
    tmap::tm_shape(inegi.ents, projection = "wgs84") +
    tmap::tm_dots(size = "POBTOT",
            contrast=1,
            sizes.legend=c(5000,50000,500000,2000000),
            title.size = thistitle) +
    #  tm_grid(col="white", labels.show = FALSE) +
    tmap::tm_scale_bar(breaks=c(0,500,1000),position = c("left", "bottom"), text.size = 0.8) +
    tmap::tm_compass(type = "arrow", position = c("right", "bottom")) +
    tmap::tm_scale_bar(breaks = c(0, 100, 200), text.size = 1)

  tmap::tmap_save(map.locs, filename=paste0(here::here(),thisoutput), width=10, height = 6, dpi = 300)

  return(map.locs)
}
