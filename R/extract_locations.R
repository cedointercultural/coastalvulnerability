#' Extract landing locations
#'
#' @param this.catchfileno
#' @param catch.files
#' @param coast.selecc
#'
#' @return
#' @export
#'
#' @examples
extract_locations <- function(this.catchfileno, catch.files, coast.selecc){

  this.catchfile <- catch.files[this.catchfileno]

  catch.file <- data.table::fread(this.catchfile, skip=2)

  catch.file.sites <- catch.file %>%
    dplyr::mutate(`NOMBRE SITIO DESEMBARQUE` = gsub("Ã‘","Ñ", `NOMBRE SITIO DESEMBARQUE`)) %>%
    dplyr::mutate(`NOMBRE SITIO DESEMBARQUE` = dplyr::na_if(`NOMBRE SITIO DESEMBARQUE`,"")) %>%
    dplyr::filter(`NOMBRE SITIO DESEMBARQUE`!="NA")

  catch.file.sites.table <- catch.file.sites %>%
    dplyr::distinct(`NOMBRE ESTADO`, `NOMBRE SITIO DESEMBARQUE`) %>%
    dplyr::rename(NOM_ENT = `NOMBRE ESTADO`, NOM_LOC = `NOMBRE SITIO DESEMBARQUE`) %>%
    dplyr::mutate(NOM_ENT= stringi::stri_trans_general(str = NOM_ENT, id = "Latin-ASCII"), NOM_ENT = toupper(NOM_ENT)) %>%
    dplyr::mutate(NOM_LOC = stringi::stri_trans_general(str = NOM_LOC, id = "Latin-ASCII"), NOM_LOC = toupper(NOM_LOC)) %>%
    dplyr::filter(NOM_ENT %in% coast.selecc) %>%
    dplyr::mutate(NOM_ENT = stringr::str_trim(NOM_ENT),NOM_LOC = stringr::str_trim(NOM_LOC))

  return(catch.file.sites.table)
}
