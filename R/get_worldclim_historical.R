#' Get data from WorldClim
#'
#' @param eachscenario
#' @param scenario.names
#' @param file.names
#' @param var.names
#' @param layer.nums
#' @param input.dir
#'
#' @description Get terrestrial historical and future layers from https://www.worldclim.org/data/cmip6/cmip6_clim30s.html
#' @return
#' @export
#'
#' @examples
get_worldclim_historical <- function(eachscenario, file.names, var.names, input.dir, r.template){

  this.file <- file.names[eachscenario]
  print(this.file)
  this.var <- var.names[eachscenario]

  this.data.layer <- terra::rast(paste0(input.dir,"/worldclim/",this.file))

  layer.file.name <- paste0(input.dir,"/exposure/cond_terrestrial/worldclim_historical_",this.var,"_2041-2060.tif")

  crop.data.layer <- terra::crop(this.data.layer, r.template)

  terra::writeRaster(crop.data.layer,layer.file.name, filetype="GTiff", overwrite = TRUE)

  unlink(this.data.layer)
  unlink(crop.data.layer)

}
