#' Add numeric variable to travel times
#'
#' @param thisnum
#' @param names.categ
#' @param pov.ind.codes
#'
#' @return
#' @export
#'
#' @examples
add_varcategory <- function(thisnum, names.categ, pov.ind.codes){

  this.variable <- names.categ[thisnum]

  this.data <- pov.ind.codes[,thisnum]

  val.categories <- dplyr::distinct(this.data[,1]) %>%
    dplyr::pull(.)

  # sym() from the rlang package is used to convert the variable name (as a string) to a symbol.
  # !! is used to unquote the symbol within mutate, allowing it to be evaluated as a variable name.
  # := is used to assign values to a new column in mutate.
  #
  if("60 o más" %in% val.categories){

    new.data <-  this.data %>%
      dplyr::mutate(!!rlang::sym(this.variable):=dplyr::if_else(!!rlang::sym(this.variable)=="Menos de 10", "5",
                                                                dplyr::if_else(!!rlang::sym(this.variable)=="10 a menos de 20", "15",
                                                                               dplyr::if_else(!!rlang::sym(this.variable)=="20 a menos de 30", "25",
                                                                                              dplyr::if_else(!!rlang::sym(this.variable)=="Menos de 10", "5",
                                                                                                             dplyr::if_else(!!rlang::sym(this.variable)=="30 a menos de 40", "35",
                                                                                                                            dplyr::if_else(!!rlang::sym(this.variable)=="40 a menos de 50", "45",
                                                                                                                                           dplyr::if_else(!!rlang::sym(this.variable)=="50 a menos de 60", "55",
                                                                                                                                                          dplyr::if_else(!!rlang::sym(this.variable)=="60 o más", "65", NA_character_)))))))))

  }

  if("Menos de 0:30" %in% val.categories){

    new.data <-  this.data %>%
      dplyr::mutate(!!rlang::sym(this.variable):=dplyr::if_else(!!rlang::sym(this.variable)=="Menos de 0:30", "15",
                                                                dplyr::if_else(!!rlang::sym(this.variable)=="0:30 a menos de 1:00", "45",
                                                                               dplyr::if_else(!!rlang::sym(this.variable)=="1:00 a menos de 1:30", "75",
                                                                                              dplyr::if_else(!!rlang::sym(this.variable)=="1:30 a menos de 2:00", "105",
                                                                                                             dplyr::if_else(!!rlang::sym(this.variable)=="2:00 a menos de 2:30", "135",
                                                                                                                            dplyr::if_else(!!rlang::sym(this.variable)=="2:30 a menos de 3:00", "165",
                                                                                                                                           dplyr::if_else(!!rlang::sym(this.variable)=="3:00 o más", "195", NA_character_))))))))

  }

  if("Menos de 5" %in% val.categories){

    new.data <-  this.data %>%
      dplyr::mutate(!!rlang::sym(this.variable):=dplyr::if_else(!!rlang::sym(this.variable)=="Menos de 5", "2.5",
                                                                dplyr::if_else(!!rlang::sym(this.variable)=="5 a menos de 10", "7.5",
                                                                               dplyr::if_else(!!rlang::sym(this.variable)=="10 a menos de 15", "12.5",
                                                                                              dplyr::if_else(!!rlang::sym(this.variable)=="15 a menos de 20", "17.5",
                                                                                                             dplyr::if_else(!!rlang::sym(this.variable)=="20 a menos de 25", "22.5",
                                                                                                                            dplyr::if_else(!!rlang::sym(this.variable)=="25 a menos de 30", "27.5",
                                                                                                                                           dplyr::if_else(!!rlang::sym(this.variable)=="30 o más", "32.5",NA_character_))))))))

  }

  if("120 o más" %in% val.categories){

    new.data <-  this.data %>%
      dplyr::mutate(!!rlang::sym(this.variable):=dplyr::if_else(!!rlang::sym(this.variable)=="Menos de 10", "5",
                                                                dplyr::if_else(!!rlang::sym(this.variable)=="10 a menos de 20", "15",
                                                                               dplyr::if_else(!!rlang::sym(this.variable)=="20 a menos de 30", "25",
                                                                                              dplyr::if_else(!!rlang::sym(this.variable)=="30 a menos de 40", "35",
                                                                                                             dplyr::if_else(!!rlang::sym(this.variable)=="40 a menos de 50", "45",
                                                                                                                            dplyr::if_else(!!rlang::sym(this.variable)=="50 a menos de 60", "55",
                                                                                                                                           dplyr::if_else(!!rlang::sym(this.variable)=="60 a menos de 120", "90",
                                                                                                                                                          dplyr::if_else(!!rlang::sym(this.variable)=="120 o más", "155",NA_character_)))))))))

  }

  new.data.code <- new.data %>%
    dplyr::mutate_if(is.character, list(as.numeric))

  return(new.data.code)

}
