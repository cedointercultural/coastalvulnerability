#' Plot component scores
#'
#' @param this.data
#' @param cost.data.comms
#' @param scenario.name
#' @param cols
#' @param ent.ord
#' @param title.txt
#'
#' @return
#' @export
#'
#' @examples
plot_change <- function(this.data, cost.data.comms, scenario.name, cols, ent.ord, title.txt){

  tot.res.ord.ent <- tot.res.ord %>%
    dplyr::left_join(cost.data.comms, by=c("CVE_LOC")) %>%
    mutate(NOM_ENT_fac=factor(NOM_ENT, levels=ent.ord))

    pointplot.vulne <- this.data %>%
    keep_when(grepl("exposure",component)) %>%
    ggplot2::ggplot()+
    ggplot2::geom_point(ggplot2::aes(y= change_score, x=NOM_ENT, color=NOM_ENT), alpha = 0.85) +
    ggplot2::facet_wrap(~ NOM_ENT) +
    #scale_colour_gradientn(colours= cols) +
    #ggplot2::scale_color_gradient(low=cols[2],high=cols[1]) +
    ggplot2::theme_light() +
      ggplot2::theme(axis.text = ggplot2::element_blank())
    ggplot2::labs(x = "Capacidad de adaptación",
                  y="Exposición",
                  title = paste(title.txt),
                  color = "Susceptibilidad",
                  size = "Población total") +
    ggplot2::annotate("text",x = 0.3, y = 0.9, label = "Alta \n vulnerabilidad", color = "gray35",size = 2.2) +
    ggplot2::annotate("text",x = 0.7, y = 0.1, label = "Baja \n vulnerabilidad", color = "gray35",size = 2.2) +
    ggplot2::scale_x_reverse()+
    ggplot2::scale_size_continuous(range  = c(1, 12),
                          limits = c(1, 2000000),
                          breaks = c(5000, 25000, 100000, 2000000))

  ggplot2::ggsave(here::here("outputs","figures",paste0(scenario.name,"_components_state.png")), pointplot.vulne, device="png", width = 10, height = 8)

  return(pointplot.vulne)

}
