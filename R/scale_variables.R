#' Scale variable
#'
#' @param datatable
#' @param sspscenario
#'
#' @return num.scale data with scaled total
#' @export
#'
#' @examples scaled.exp <- scale_var(exp.data.set.sc, NA)
scale_var <- function(datatable, sspscenario){


  cost.data.vals <- cost.data.pob.ind %>%
    replace(is.na(.), 0) %>%
    mutate(!!var := rowSums(dplyr::across(10:max.col), na.rm=TRUE)) %>%
    keep_when(!!var>0)

  cost.data.index <- cost.data.vals %>%
    dplyr::select(CVE_ENT:deci_lat)

  readr::write_csv(cost.data.index, here::here("data-raw",paste0(indicator.name,"_coastal_comm.csv")))

  cost.data.data <- cost.data.vals %>%
    dplyr::select(!(CVE_ENT:deci_lat))

  list.cols <- list()

  for(eachcol in 1:ncol(cost.data.data)){

    print(eachcol)
    this.col <- cost.data.data %>%
      select({eachcol})

    process.num <- caret::preProcess(this.col, method=c("range"))

    scaled.this.col <- stats::predict(process.num, this.col)

    list.cols[[eachcol]] <- scaled.this.col

  }

  scaled.cols <- list.cols %>%
    dplyr::bind_cols()

  ind.pob.sc <- dplyr::bind_cols(cost.data.index, scaled.cols)

  readr::write_csv(ind.pob.sc, here::here("data-raw",paste(var,".csv")))




  this.varname <- this.data %>%
    dplyr::distinct(variable) %>%
    dplyr::pull(variable)

  this.sc <- this.data %>%
    dplyr::distinct(scenario) %>%
    dplyr::pull(scenario)

  this.col <- this.data$value %>%
    as.data.frame()

  process.num <- caret::preProcess(this.col, method=c("range"))

  scaled.this.col <- stats::predict(process.num, this.col)

  colnames(scaled.this.col) <- "value"


  return(num.scale)
}
