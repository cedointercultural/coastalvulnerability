#' @title Query INEGI location catalog
#'
#' @param this.loc
#' @param ent.codes
#' @return data.locs
#' @export
#'
#' @author Hem Nalini Morzaria Luna
#' @date MAr 2024
#' @description Obtener localidades del catalogo de INEGI usando el servicio JSON
#' @description https://www.inegi.org.mx/servicios/catalogounico.html
#' @example
local_inegi <- function(this.loc, ent.codes) {

  this.url <- paste0("https://gaia.inegi.org.mx/wscatgeo/localidades/buscar/",this.loc)
  this.json.data <- jsonlite::fromJSON(this.url)

  data.locs <- this.json.data$datos %>%
    dplyr::left_join(ent.codes, by = c("cve_agee","cve_agem")) %>%
    dplyr::filter(!is.na(ent_nam))

  return(data.locs)

}
