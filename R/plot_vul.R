#' Plot vulnerability
#'
#' @param this.data
#' @param ent.ord
#' @param ent.cols
#' @param title.txt
#'
#' @return
#' @export
#'
#' @examples
plot_vul <- function(this.data, ent.ord, ent.cols, title.txt){

  this.data.plot <- this.data %>%
    mutate(NOM_ENT_fac=factor(NOM_ENT, levels=ent.ord))

  ent.boxplot <- this.data.plot %>%
    ggplot2::ggplot(ggplot2::aes(x=vul_score, y=NOM_ENT_fac, color = NOM_ENT_fac)) +
    ggplot2::geom_boxplot(alpha=0.8, outlier.shape = NA) +
    ggplot2::geom_point(ggplot2::aes(color = NOM_ENT_fac), position = ggplot2::position_jitter(width = 0.4, height = 0.2), size = 1, alpha = 0.5) +
    ggplot2::scale_color_manual(values= ent.cols) +
    ggplot2::geom_vline(xintercept = 0, color = "black", linetype = "dashed") +
    ggplot2::labs(x = "Vulnerabilidad",
                  y="Entidad",
                  title = paste(title.txt),
                  color = "Entidad") +
    ggplot2::xlim(-1.5, 2)

  ggplot2::ggsave(here::here("outputs","figures",paste0(title.txt,"vul_state.png")), ent.boxplot, device="png", width = 11, height = 9)

  return(ent.boxplot)

}
